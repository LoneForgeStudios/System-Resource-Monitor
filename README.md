# Мониторинг системы с уведомлениями в Telegram

Инструмент на Python для мониторинга ресурсов системы (CPU, память, диск, сеть) с отправкой уведомлений и статуса в Telegram-бот. Поддерживает настраиваемые пороги, логирование с ротацией и сохранение состояния.

![Python](https://img.shields.io/badge/Python-3.7%2B-blue)
![License](https://img.shields.io/badge/License-MIT-green)
![Version](https://img.shields.io/badge/Version-1.0-green)

## Возможности
- **Мониторинг ресурсов**:
  - Отслеживание загрузки CPU (%).
  - Мониторинг использования памяти (%).
  - Проверка заполненности диска для указанных путей (%).
  - Измерение сетевого трафика (отправка/получение в МБ/с).
- **Интеграция с Telegram-ботом**:
  - Отправка уведомлений о превышении порогов (INFO, WARNING, CRITICAL, ERROR).
  - Поддержка команд: `/start`, `/status`, `/stats`, `/alerts`, `/config`, `/enable`, `/disable`, `/restart`, `/full_restart`, `/help`.
  - Интерактивная клавиатура и inline-кнопки для удобного управления.
- **Конфигурация**:
  - Использует файл `config.yaml` для настройки интервалов мониторинга, порогов и Telegram.
  - Автоматически создаёт конфиг по умолчанию, если файл отсутствует.
- **Логирование**:
  - Сохранение логов в файл с ротацией (настраиваемый размер и количество копий).
  - Отдельный файл для ошибок Telegram.
  - Вывод логов в консоль для отладки.
- **Сохранение состояния**:
  - Сохранение истории уведомлений и статистики в `monitor_state.json`.
  - Восстановление состояния при перезапуске.
- **Обработка ошибок**:
  - Устойчивая обработка ошибок доступа к диску, проблем с Telegram API и конфигурацией.
  - Корректное завершение работы с сохранением состояния при прерывании.

## Требования
- Python 3.7+
- Зависимости (указаны в `requirements.txt`):
  - `psutil==5.9.5`
  - `requests==2.31.0`
  - `pyyaml==6.0`
  - `python-telegram-bot==20.3`
  - `python-dotenv==1.0.0`

## Установка
1. Склонируйте репозиторий:
   ```bash
   git clone https://github.com/LoneForgeStudios/System-Resource-Monitor.git
   cd System-Resource-Monitor

2. Установите зависимости:
   ```bash
   pip install -r requirements.txt

4. Настройте Telegram-бот:
   ```bash
   1 - Создайте бота через @BotFather и получите токен.
   2 - Узнайте ваш chat ID через @userinfobot.
   3 - Отредактируйте config.yaml, добавив токен и chat ID: bot_token: "your_bot_token_here" chat_id: "your_chat_id_here"
   
4. (Опционально) Настройте config.yaml для изменения интервалов и порогов:
   ```bash
   monitoring:
   check_interval_seconds: 60
   notification_cooldown_seconds: 300
   resources:
    cpu:
      enabled: true
      threshold: 80
    memory:
      enabled: true
      threshold: 80
    disk:
      enabled: true
      threshold: 80
      paths: ["/"]
    network:
      enabled: true
      threshold_sent_mbps: 10
      threshold_recv_mbps: 10

7. Запустите скрипт:
   ```bash
   python monitor.py

## Использование

Скрипт автоматически начинает мониторинг и отправляет уведомления в Telegram при превышении порогов.
### Команды Telegram-бота: 
    
    /status — текущий статус системы (CPU, память, диск, сеть).
    /stats — статистика мониторинга (количество проверок, уведомлений).
    /alerts — история последних уведомлений (до 10 записей).
    /config — текущие пороговые значения.
    /enable — включить мониторинг.
    /disable — выключить мониторинг.
    /restart — перезапустить мониторинг.
    /full_restart — полный перезапуск приложения.
    /help — список доступных команд.


#### Используйте клавиатуру или inline-кнопки для быстрого доступа к командам.

### Конфигурация

Файл: config.yaml
#### Параметры:
    Logging: уровень логов, путь к файлу, максимальный размер, количество резервных копий.
    Monitoring: интервал проверок, задержка между уведомлениями, пороги для ресурсов.
    Notifications.telegram: включение/выключение Telegram, токен бота, chat ID.


Если файл config.yaml отсутствует, создаётся конфигурация по умолчанию с инструкциями.

### Логирование

Логи сохраняются в monitor.log с ротацией(опционально).
Ошибки Telegram записываются в telegram_errors.log.
Логи также выводятся в консоль.
